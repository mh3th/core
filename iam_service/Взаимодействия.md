# Структура взаимодействия views и controllers

## 1. Регистрация аккаунта (Account Registration)

- **View**: Страница регистрации
  - **URL**: `/register`
  - **Описание**: Пользователь видит форму для регистрации, где он вводит email, пароль и другие необходимые данные.
  - **Контроллер**: `RegisterController` (обрабатывает вывод формы регистрации)
  - **Запрос от пользователя**: `GET /register`
  - **Отдает**: HTML-форму для регистрации (вызывает `GET /register`)

- **Действие после отправки формы регистрации**:
  - **Контроллер**: `RegisterController`
  - **Запрос от клиента**: `POST /accounts` (после отправки формы)
  - **Описание**: Контроллер обрабатывает запрос на создание аккаунта, и при успешной регистрации перенаправляет пользователя на страницу подтверждения аккаунта.
  - **Переход**: После успешной регистрации на **`/accounts/{account_id}/confirm`**

---

## 2. Подтверждение аккаунта (Account Confirmation)

- **View**: Страница подтверждения аккаунта
  - **URL**: `/accounts/{account_id}/confirm`
  - **Описание**: Пользователь вводит код подтверждения, полученный по email.
  - **Контроллер**: `ConfirmAccountController`
  - **Запрос от пользователя**: `GET /accounts/{account_id}/confirm`
  - **Отдает**: HTML-форму для подтверждения аккаунта (вызывает `GET /accounts/{account_id}/confirm`)

- **Действие после отправки формы подтверждения**:
  - **Контроллер**: `ConfirmAccountController`
  - **Запрос от клиента**: `POST /accounts/{account_id}/confirm`
  - **Описание**: Контроллер проверяет код подтверждения, и при успешной проверке перенаправляет на страницу профиля или входа.
  - **Переход**: При успехе на **`/login`** или **`/accounts/{account_id}`**

---

## 3. Логин (Login)

- **View**: Страница логина
  - **URL**: `/login`
  - **Описание**: Пользователь вводит email и пароль для входа в систему.
  - **Контроллер**: `LoginController`
  - **Запрос от пользователя**: `GET /login`
  - **Отдает**: HTML-форму для логина (вызывает `GET /login`)

- **Действие после отправки формы логина**:
  - **Контроллер**: `LoginController`
  - **Запрос от клиента**: `POST /sessions`
  - **Описание**: Контроллер проверяет учетные данные и создает сессию. При успешном входе перенаправляет на защищенную страницу.
  - **Переход**: При успехе на **`/dashboard`**

---

## 4. Профиль пользователя (User Profile)

- **View**: Страница профиля пользователя
  - **URL**: `/accounts/{account_id}`
  - **Описание**: Пользователь видит свою учетную информацию (email, username и другие данные).
  - **Контроллер**: `ProfileController`
  - **Запрос от пользователя**: `GET /accounts/{account_id}`
  - **Отдает**: HTML-страницу с информацией профиля (вызывает `GET /accounts/{account_id}`)

- **Действие после редактирования профиля**:
  - **Контроллер**: `ProfileController`
  - **Запрос от клиента**: `PUT /accounts/{account_id}`
  - **Описание**: Контроллер обновляет данные профиля и перенаправляет обратно на страницу профиля.
  - **Переход**: Перезагрузка страницы профиля после обновления.

---

## 5. Смена пароля (Change Password)

- **View**: Страница смены пароля
  - **URL**: `/accounts/{account_id}/password`
  - **Описание**: Пользователь вводит старый и новый пароль.
  - **Контроллер**: `PasswordController`
  - **Запрос от пользователя**: `GET /accounts/{account_id}/password`
  - **Отдает**: HTML-форму для смены пароля (вызывает `GET /accounts/{account_id}/password`)

- **Действие после отправки формы смены пароля**:
  - **Контроллер**: `PasswordController`
  - **Запрос от клиента**: `PUT /accounts/{account_id}/password`
  - **Описание**: Контроллер обновляет пароль пользователя и перенаправляет на страницу профиля.
  - **Переход**: После успешного обновления перенаправление на **`/accounts/{account_id}`**

---

## 6. Смена email (Change Email)

- **View**: Страница смены email
  - **URL**: `/accounts/{account_id}/email`
  - **Описание**: Пользователь вводит новый email для смены.
  - **Контроллер**: `EmailController`
  - **Запрос от пользователя**: `GET /accounts/{account_id}/email`
  - **Отдает**: HTML-форму для смены email (вызывает `GET /accounts/{account_id}/email`)

- **Действие после отправки формы смены email**:
  - **Контроллер**: `EmailController`
  - **Запрос от клиента**: `PUT /accounts/{account_id}/email`
  - **Описание**: Контроллер обновляет email пользователя и перенаправляет на страницу подтверждения нового email.
  - **Переход**: Перенаправление на **`/accounts/{account_id}/confirm`** для подтверждения нового email.

---

## 7. Выход (Logout)

- **View**: Страница подтверждения выхода
  - **URL**: `/logout`
  - **Описание**: Подтверждение выхода из системы, где пользователь может завершить текущую сессию.
  - **Контроллер**: `LogoutController`
  - **Запрос от пользователя**: `GET /logout`
  - **Отдает**: Страница с кнопкой для выхода (вызывает `GET /logout`)

- **Действие после подтверждения выхода**:
  - **Контроллер**: `LogoutController`
  - **Запрос от клиента**: `DELETE /sessions/{session_id}`
  - **Описание**: Контроллер завершает текущую сессию и перенаправляет на главную страницу.
  - **Переход**: Перенаправление на **`/`**

---

## 8. Сброс пароля (Reset Password)

- **View**: Страница запроса сброса пароля
  - **URL**: `/reset-password`
  - **Описание**: Пользователь вводит свой email для получения инструкции по сбросу пароля.
  - **Контроллер**: `ResetPasswordController`
  - **Запрос от пользователя**: `GET /reset-password`
  - **Отдает**: HTML-форму для запроса сброса пароля (вызывает `GET /reset-password`)

- **Действие после отправки формы сброса пароля**:
  - **Контроллер**: `ResetPasswordController`
  - **Запрос от клиента**: `POST /accounts/reset-password`
  - **Описание**: Контроллер обрабатывает запрос на сброс пароля и отправляет инструкции по email.
  - **Переход**: Перенаправление на **страницу подтверждения сброса пароля** или уведомление об успешной отправке.

---

## 9. Подтверждение сброса пароля (Confirm Reset Password)

- **View**: Страница ввода нового пароля
  - **URL**: `/reset-password/{token}`
  - **Описание**: Пользователь вводит новый пароль, используя токен для подтверждения сброса.
  - **Контроллер**: `ConfirmResetPasswordController`
  - **Запрос от пользователя**: `GET /reset-password/{token}`
  - **Отдает**: HTML-форму для ввода нового пароля (вызывает `GET /reset-password/{token}`)

- **Действие после отправки формы**:
  - **Контроллер**: `ConfirmResetPasswordController`
  - **Запрос от клиента**: `POST /accounts/reset-password/{token}`
  - **Описание**: Контроллер обрабатывает установку нового пароля.
  - **Переход**: Перенаправление на **`/login`**
