# Описание IAM сервиса
## Назначение
Этот сервис регистрирует пользователей, выдаем им токены для входа в систему.
Выдает публичные ключи для доступа к другим сервисам, включая ротацию ключей.
## Основные сущности
   - **Account (Аккаунт)**: Учетная запись пользователя, содержащая данные о пользователе, такие как email, пароль, и другие профилирующие данные.
   - **Access token (Токен доступа)**: Токен, который выдается пользователю после успешного входа в систему.
   - **Refresh token (Токен обновления)**: Токен, который выдается пользователю для обновления токена доступа.
   - **Public key (Публичный ключ)**: Ключ, который выдается пользователю для доступа к другим сервисам.
## Основные функции
   1. **Регистрация аккаунта**: Пользователь может зарегистрировать новую учетную запись.
   2. **Подтверждение регистрации**: Пользователь подтверждает свою учетную запись с помощью кода, отправленного по email.
   3. **Логин, выдача jwt ключей в куки**: Пользователь может войти в систему.
   4. **Обновление jwt токенов**: Пользователь может обновить токены доступа.
   5. **Логаут, удаление**: Пользователь может выйти из системы.
## Основные юзкейсы
   1. **Создание аккаунта**: Пользователь может создать новый аккаунт.
   2. **Подтверждение аккаунта**: Пользователь может подтвердить свою учетную запись.
   3. **Создание jwt токенов**: Пользователь может создать новые токены для входа в систему.
   4. **Обновление jwt токенов**: Пользователь может обновить токены доступа.
   5. **Удаление jwt токенов**: Пользователь может удалить токены доступа.
   6. **Получение публичных ключей**: Сервис публикует публичные ключи для доступа к другим сервисам.
## API
   1. Регистрация аккаунта
      - **URL**: `POST /account`
      - **Описание**: Создание нового аккаунта пользователя.
      - **Контроллер**: `account_controller`
   2. Подтверждение аккаунта
      - **URL**: `POST /account/confirm`
      - **Описание**: Подтверждение учетной записи пользователя.
      - **Контроллер**: `confirm_controller`
   3. Логин
      - **URL**: `POST /account/tokens`
      - **Описание**: Создание новых токенов доступа.
      - **Контроллер**: `tokens_controller`
   4. Обновление токенов
      - **URL**: `PUT /account/tokens`
      - **Описание**: Обновление токенов доступа.
      - **Контроллер**: `tokens_controller`
   5. Удаление токенов
      - **URL**: `DELETE /account/tokens`
      - **Описание**: Удаление токенов доступа.
      - **Контроллер**: `tokens_controller`
   6. Получение публичных ключей
      - **URL**: `GET /public-keys`
      - **Описание**: Получение публичных ключей для доступа к другим сервисам.
      - **Контроллер**: `public_keys_controller`
## UI
   1. **Регистрация**: 
      - **URL**: `GET /account/signup`
      - **Описание**: Пользователю выдается форма для регистрации.
      - **Контроллер**: `signup_controller`
      - **Вызывает**: `POST /account`
      - **Успех**: Redirect на `/account/confirm`
      - **Ошибка**: Отображение ошибок валидации или других ошибок на форме регистрации.
   2. **Подтверждение аккаунта**:
      - **URL**: `GET /account/confirm`
      - **Описание**: Пользователю выдается форма для ввода кода подтверждения.
      - **Контроллер**: `confirm_controller`
      - **Вызывает**: `POST /account/confirm`
      - **Успех**: Redirect на `/login`
      - **Ошибка**: Отображение ошибок валидации или других ошибок на форме подтверждения.
   3. **Логин**
      - **URL**: `GET /account/signin`
      - **Описание**: Пользователю выдается форма для входа в систему.
      - **Контроллер**: `signin_controller`
      - **Вызывает**: `POST /accounts/tokens`
      - **Успех**: Redirect на `/`
      - **Ошибка**: Отображение ошибок валидации или других ошибок на форме входа.
   4. **Данные аккаунта**
      - **URL**: `GET /account`
      - **Описание**: Пользователю выдается информация об аккаунте.
      - **Контроллер**: `account_controller`
      - **Вызывает**: `GET /account`
      - **Успех**: Отображение данных аккаунта.
      - **Ошибка**: Отображение ошибок.
## Стек технологий
- **Back-end**: REST API axum sqlx postgres.
- **Front-end**: HTMX для асинхронной работы с сервером без перезагрузки страниц.