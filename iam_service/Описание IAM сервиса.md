# Описание IAM сервиса

## Назначение
Это сервис для управления аутентификацией, регистрацией и сессиями пользователей, основанный на принципах REST API с использованием HATEOAS. Основные сущности включают аккаунты (accounts) и сессии (sessions), а пользователи могут создавать учетные записи, подтверждать их, логиниться, менять пароли и email, а также управлять своими сессиями.

## Основные сущности
- **Account (Аккаунт)**: Учетная запись пользователя, содержащая данные о пользователе, такие как email, пароль, и другие профилирующие данные.
- **Session (Сессия)**: Активный сеанс пользователя, используемый для доступа к защищенным ресурсам.

## Основные функции
1. **Регистрация аккаунта**: Пользователь может зарегистрировать новую учетную запись.
2. **Подтверждение регистрации**: Пользователь подтверждает свою учетную запись с помощью кода, отправленного по email.
3. **Логин (Создание сессии)**: Пользователь может войти в систему, создав новую сессию.
4. **Смена пароля**: Пользователь может изменить свой пароль.
5. **Смена email**: Пользователь может изменить свой email, после чего потребуется его подтверждение.
6. **Сброс пароля**: Пользователь может запросить сброс пароля и установить новый через отправленный код.
7. **Управление сессиями**: Пользователь может завершить сессию (выйти из системы).

## Маршруты (REST API)

### 1. Регистрация аккаунта
- **URL**: `POST /accounts`
- **Описание**: Создание нового аккаунта пользователя.

### 2. Подтверждение регистрации
- **URL**: `POST /accounts/{account_id}/confirm`
- **Описание**: Подтверждение учетной записи пользователя.

### 3. Логин (Создание сессии)
- **URL**: `POST /sessions`
- **Описание**: Создание новой сессии пользователя.

### 4. Смена пароля
- **URL**: `PUT /accounts/{account_id}/password`
- **Описание**: Обновление пароля пользователя.

### 5. Смена email
- **URL**: `PUT /accounts/{account_id}/email`
- **Описание**: Обновление email-адреса пользователя.

### 6. Логаут (Удаление сессии)
- **URL**: `DELETE /sessions/{session_id}`
- **Описание**: Завершение текущей сессии пользователя.

### 7. Сброс пароля
- **URL**: `POST /accounts/reset-password`
- **Описание**: Инициирование сброса пароля пользователя.

### 8. Подтверждение сброса пароля
- **URL**: `POST /accounts/reset-password/{token}`
- **Описание**: Установка нового пароля с использованием токена.

## Взаимодействие с UI

### Страницы

1. **Регистрация**: `/register`
   - Форма для создания нового аккаунта.
   - Вызов контроллера: `POST /accounts`

2. **Подтверждение аккаунта**: `/accounts/{account_id}/confirm`
   - Форма для ввода кода подтверждения.
   - Вызов контроллера: `POST /accounts/{account_id}/confirm`

3. **Логин**: `/login`
   - Форма для входа в систему.
   - Вызов контроллера: `POST /sessions`

4. **Профиль пользователя**: `/accounts/{account_id}`
   - Отображение и редактирование профиля.
   - Вызов контроллера: `PUT /accounts/{account_id}`

5. **Смена пароля**: `/accounts/{account_id}/password`
   - Форма для смены пароля.
   - Вызов контроллера: `PUT /accounts/{account_id}/password`

6. **Смена email**: `/accounts/{account_id}/email`
   - Форма для смены email.
   - Вызов контроллера: `PUT /accounts/{account_id}/email`

7. **Сброс пароля**: `/reset-password`
   - Форма для запроса сброса пароля.
   - Вызов контроллера: `POST /accounts/reset-password`

8. **Подтверждение сброса пароля**: `/reset-password/{token}`
   - Форма для ввода нового пароля с токеном.
   - Вызов контроллера: `POST /accounts/reset-password/{token}`

## Стек технологий
- **Back-end**: REST API axum
- **Front-end**: HTMX для асинхронной работы с сервером без перезагрузки страниц.
